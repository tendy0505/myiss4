!function(o){o(document).ready(function(){function d(t){return t.split(/,\s*/)}o(".wff_ajax_form").each(function(){var e=o(this),a=e.find(".form_button"),n=e.find(".form_action").val()||"";e.find(".wffwt_submit").append('<div class="wf_notes"></div>');var i=e.find(".wf_notes");a.click(function(t){t.preventDefault();t=e.serialize();if(i.removeClass("_error _ok").empty(),a.hasClass("ld"))return i.html("Please hold on till the last request completes").addClass("_error"),!1;a.addClass("ld").attr("disabled","disabled"),e.data("loading_text"),i.html(e.data("loading_text")).addClass("_note ld"),o.post(ajaxurl,t).done(function(t){"0"==t?i.html("Invalid form response.").addClass("_error"):i.html(t.html).addClass("_"+t.status),n&&o(window).trigger(n,t)}).complete(function(t){a.removeClass("ld").removeAttr("disabled"),i.removeClass("ld")})})}),o(document.body).on("click",".wff_ajax_action_btn",function(t){t.preventDefault();var e=o(this),a=e.data("action")||"",n=e.data("target")||"";if(_confirm=e.data("confirm")||"",_alert=e.data("alert"),e.hasClass("ld")||""==a)return!1;if(_confirm&&!confirm(_confirm))return!1;var i=e.data("form")?o(e.data("form")).serialize()+"&action="+a:e.data();e.addClass("ld").attr("disabled","disabled"),o.post(ajaxurl,i).done(function(t){"ok"!=t.status&&"error"!=t.status||(n?o(n).html(t.html):"1"==_alert&&alert(t.html)),o(window).trigger(a,[t,i,e])}).complete(function(){e.removeClass("ld").removeAttr("disabled")})}),o(document.body).on("click",".wff_clone_btn",function(t){t.preventDefault();var e=o(this).closest(".wff_clone_wrap"),a=e.find(".wff_clone_to"),t=e.find(".wff_clone_from").html();return a.append(t),o(window).trigger("w4pl/row_cloned"),""!=e.attr("id")&&o(window).trigger("wff_cloned_"+e.attr("id")),!1}),o(document.body).on("click",".wff_clone_remove_btn",function(t){return t.preventDefault(),o(this).closest(".wff_clone_item").remove(),!1}),o(".wff_clone_to.sortable").sortable({items:"tr",handle:".wff_clone_drag_handle",helper:function(t,e){var a=e.children(),e=e.clone();return e.children().each(function(t){o(this).width(a.eq(t).width())}),e}}),o(".checkbox_limit2").each(function(t,e){var a=o(this),n=a.data("max"),i=a.find("input[type=checkbox]:checked").length>=n;a.find("input[type=checkbox]").not(":checked").attr("disabled",i),a.find("input[type=checkbox]").click(function(){var t=a.find("input[type=checkbox]:checked").length>=n;a.find("input[type=checkbox]").not(":checked").attr("disabled",t)})}),o(".checkbox_limit").each(function(t,e){var a=o(this);a.find("input[type=checkbox]").click(function(){var t=o(this);!function t(e,a){var n=void 0!==a.attr("checked"),i=a.data("parent"),a=o("#term_"+i);0<a.length&&(!n&&a.is(":checked")?(_shiblings=o("input[data-parent="+i+"]:checked").length,_shiblings<1&&a.removeAttr("checked").removeAttr("disabled")):n&&a.not(":checked")&&a.attr("checked",!0).attr("disabled",!0),t(e,a));var c=0;e.find("input[type=checkbox]:checked").each(function(t,e){o("input[data-parent="+o(e).data("tid")+"]:checked").length<1&&c++});a=c>=e.data("max");e.find("input[type=checkbox]:checked"),e.find("input[type=checkbox]").not(":checked").attr("disabled",a)}(a,t)})}),o(".tags_limit").each(function(t,e){var a=o(this),n=a.data("max"),i=a.data("sep");a.find("input[type=text]").bind("keypress",function(t){String.fromCharCode(t.which)==i&&8!=t.which&&0!=t.which&&(t.which<48||57<t.which)&&46!=t.which&&a.find("input[type=text]").val().replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"").split(i).length>=n&&t.preventDefault()})}),o("[data-term_suggest2]").each(function(t,e){var a=o(e),n=a.find("input"),e=a.data("term_suggest");n.suggest(UGC.ajaxurl+"?action=UGC_term_suggest&tax="+e,{delay:500,minchars:2,multiple:1,onSelect:function(t){a.hasClass("tags_limit")&&(tags=a.find("input[type=text]").val(),tags=tags.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),tags=tags.split(a.data("sep")),tags.length>=a.data("max")&&n.val(tags.join(a.data("sep")+" ")))}})}),o("[data-auc]").each(function(t,e){var a=o(e),e=a.find("input"),n=a.data("max")||10,i=a.data("sep")||",",c=a.data("auc");if(c.length<1)return!1;e.bind("keydown focus",function(t){t.keyCode===o.ui.keyCode.TAB&&o(this).data("ui-autocomplete").menu.active&&t.preventDefault()}).autocomplete({minLength:0,source:function(t,e){e(o.ui.autocomplete.filter(c,d(t.term).pop()).slice(0,10))},focus:function(){return!1},select:function(t,e){var a=d(this.value);return a.pop(),a.push(e.item.value),a.length>=n||a.push(""),this.value=a.join(i+" "),!1}})})})}(jQuery);